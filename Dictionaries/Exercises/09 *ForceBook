data = input()
unique_force_user = {}

while not data == "Lumpawaroo":
    if "|" in data:
        force_side, force_user = data.split(" | ")
        if force_side not in unique_force_user:
            unique_force_user[force_side] = [force_user]
    if "->" in data:
        force_user, force_side = data.split(" -> ")
        if force_user in unique_force_user[force_side]:
            unique_force_user[force_user] = force_side
        else:
            unique_force_user[force_side].append(force_user)
            print(f"{force_user} joins the {force_side} side!")

    data = input()

for force_side, force_user in sorted(unique_force_user.items(), key=lambda x:x[0]):
    print(f"Side: {force_side}, Members: {len(force_user)}")
    for el in range(len(force_user)):
        print(f"! {force_user[el]}")
